digraph PRODUCTION_READINESS_WORKFLOW {
  rankdir=TB;
  node [shape=box, style="rounded,filled"];

  subgraph cluster_init {
    label="Initialization";
    style="filled,rounded";
    bgcolor="#E8F4F8";

    start [label="production-readiness\nInvoked", shape=ellipse, fillcolor=lightblue];
    load_code [label="Load Codebase\nFull Context"];
    check_deps [label="Check Audit Pipeline\nTheater, Functionality, Style"];

    start -> load_code -> check_deps;
  }

  subgraph cluster_validation {
    label="Policy Validation";
    style="filled,rounded";
    bgcolor="#FFF8E8";

    check_policy [shape=diamond, label="12-FA\nCompliant?"];
    policy_violation [shape=octagon, fillcolor=crimson, label="BLOCKED"];

    check_deps -> check_policy;
    check_policy -> policy_violation [label="Fail"];
  }

  subgraph cluster_audit_pipeline {
    label="Comprehensive Audit Pipeline";
    style="filled,rounded";
    bgcolor="#F0E8F8";

    run_theater_detection [label="1. Theater Detection Audit\nZero Tolerance", fillcolor=red];
    decision_theater [shape=diamond, label="Theater\nDetected?"];
    run_functionality_audit [label="2. Functionality Audit\nSandbox Validation", fillcolor=purple];
    decision_functionality [shape=diamond, label="Actually\nWorks?"];
    run_style_audit [label="3. Style Audit\nCode Quality", fillcolor=blue];
    decision_style [shape=diamond, label="Style\nAcceptable?"];

    check_policy -> run_theater_detection [label="Pass"];
    run_theater_detection -> decision_theater;
    decision_theater -> run_functionality_audit [label="No Theater"];
    run_functionality_audit -> decision_functionality;
    decision_functionality -> run_style_audit [label="Yes"];
    run_style_audit -> decision_style;
  }

  subgraph cluster_quality_gates {
    label="Additional Quality Gates";
    style="filled,rounded";
    bgcolor="#E8FFE8";

    performance_bench [label="Performance Benchmarks\nLoad, Memory, Speed", fillcolor=lightgreen];
    security_scan [label="Security Scan\nVulnerabilities", fillcolor=lightgreen];
    doc_check [label="Documentation Check\nREADME, API Docs", fillcolor=lightgreen];
    deployment_checklist [label="Generate Deployment Checklist", fillcolor=lightgreen];

    decision_style -> performance_bench [label="Yes"];
    performance_bench -> security_scan;
    security_scan -> doc_check;
    doc_check -> deployment_checklist;
  }

  subgraph cluster_coordination {
    label="Coordination";
    style="filled,rounded";
    bgcolor="#E8E8F8";

    memory_store [label="Store Readiness Report\nAll Gates, Checklist", fillcolor=lightblue];
    notify [label="Notify Coordinator\nProduction Ready", fillcolor=lightblue];

    deployment_checklist -> memory_store;
    memory_store -> notify;
  }

  subgraph cluster_completion {
    label="Completion";
    style="filled,rounded";
    bgcolor="#E8F8E8";

    cleanup [label="Cleanup Resources", fillcolor=lightgreen];
    log_metrics [label="Log Metrics\nGates Passed, Issues Found"];
    success [label="Production Ready\nDeploy Approved", shape=doublecircle, fillcolor=green, style="filled,bold"];
    failure [label="Not Production Ready\nBlocked", shape=doublecircle, fillcolor=red, style="filled,bold"];

    notify -> cleanup;
    cleanup -> log_metrics;
    log_metrics -> success;

    decision_theater -> failure [label="Theater"];
    decision_functionality -> failure [label="No"];
    decision_style -> failure [label="No"];
  }

  subgraph cluster_errors {
    label="Error Handling";
    style="filled,rounded";
    bgcolor="#F8E8E8";

    escalate [shape=hexagon, fillcolor=yellow, label="Escalate"];
    log_error [label="Log Error", fillcolor=orange];

    policy_violation -> log_error;
    log_error -> escalate;
    escalate -> failure;
  }
}
