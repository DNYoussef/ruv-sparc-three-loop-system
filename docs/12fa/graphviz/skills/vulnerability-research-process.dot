digraph VulnerabilityResearchSkill {
    rankdir=TB;
    node [shape=box, style="rounded,filled", fillcolor=lightblue];
    edge [color=darkblue, penwidth=2];

    // Skill definition
    start [label="vulnerability-research\nSkill Activated", fillcolor=lightgreen];

    // Phase 1: Target Analysis
    target_phase [label="PHASE 1: Target Analysis", fillcolor=lightyellow, shape=box3d];
    select_target [label="Select Target\nApplication/Binary"];
    analyze_attack_surface [label="Analyze Attack\nSurface"];
    identify_entry_points [label="Identify Entry\nPoints"];
    map_data_flow [label="Map Data Flow\nPaths"];

    // Phase 2: Static Vulnerability Discovery
    static_vuln_phase [label="PHASE 2: Static Vulnerability Discovery", fillcolor=lightyellow, shape=box3d];
    spawn_vulnerability_hunter [label="Spawn Agent:\nRE-vulnerability-hunter"];

    subgraph cluster_static_checks {
        label="Parallel Static Checks";
        style=filled;
        fillcolor=lightgrey;

        detect_memory_bugs [label="Detect Memory\nCorruption Bugs"];
        find_logic_flaws [label="Find Logic\nFlaws"];
        check_crypto_issues [label="Check Crypto\nImplementation"];
        scan_injection_points [label="Scan Injection\nPoints"];
    }

    connascence_scan [label="Run Connascence\nAnalyzer MCP"];
    triage_static_findings [label="Triage Static\nFindings"];

    // Phase 3: Dynamic Vulnerability Testing
    dynamic_vuln_phase [label="PHASE 3: Dynamic Testing", fillcolor=lightyellow, shape=box3d];
    setup_fuzzing [label="Setup Fuzzing\nInfrastructure"];
    configure_fuzzer [label="Configure Fuzzer\n(AFL++/libFuzzer)"];
    generate_corpus [label="Generate Initial\nCorpus"];
    run_fuzzing_campaign [label="Run Fuzzing\nCampaign"];
    monitor_coverage [label="Monitor Code\nCoverage"];
    detect_crashes [label="Detect Crashes\n& Hangs"];

    // Phase 4: Crash Analysis
    crash_analysis_phase [label="PHASE 4: Crash Analysis", fillcolor=lightyellow, shape=box3d];
    triage_crashes [label="Triage Crash\nCases"];
    minimize_testcase [label="Minimize Test\nCase"];
    analyze_root_cause [label="Analyze Root\nCause"];
    classify_vulnerability [label="Classify Vulnerability\n(CWE)"];
    assess_severity [label="Assess Severity\n(CVSS Score)"];

    // Phase 5: Exploitability Analysis
    exploit_phase [label="PHASE 5: Exploitability Analysis", fillcolor=lightyellow, shape=box3d];
    check_mitigations [label="Check Security\nMitigations"];
    analyze_constraints [label="Analyze Exploitation\nConstraints"];
    develop_exploit_strategy [label="Develop Exploit\nStrategy"];
    build_poc [label="Build Proof of\nConcept Exploit"];
    test_exploit [label="Test Exploit\nReliability"];
    refine_exploit [label="Refine Exploit\nTechnique"];

    // Phase 6: Disclosure & Reporting
    disclosure_phase [label="PHASE 6: Disclosure & Reporting", fillcolor=lightyellow, shape=box3d];
    prepare_advisory [label="Prepare Security\nAdvisory"];
    assign_cve [label="Request CVE\nAssignment"];
    coordinate_disclosure [label="Coordinate Responsible\nDisclosure"];
    generate_report_cmd [label="Execute:\nRE-generate-report"];
    document_impact [label="Document Impact\n& Mitigation"];

    // Phase 7: Patch Development (Optional)
    patch_phase [label="PHASE 7: Patch Development (Optional)", fillcolor=lightyellow, shape=box3d];
    develop_patch [label="Develop Security\nPatch"];
    test_patch [label="Test Patch\nEffectiveness"];
    patch_binary_cmd [label="Execute:\nRE-patch-binary"];
    verify_patch [label="Verify Patch Doesn't\nBreak Functionality"];

    // Integration
    memory_store [label="Store in Memory MCP\n(Vulnerabilities, Exploits)"];
    share_findings [label="Share Findings\nwith Security Community"];

    // Output
    deliverables [label="Deliverables:\n- Vulnerability Report\n- POC Exploit\n- CVE Entry\n- Security Advisory\n- Patch (if applicable)"];
    end [label="Vulnerability Research\nComplete", fillcolor=lightcoral];

    // Flow - Target Analysis
    start -> target_phase;
    target_phase -> select_target;
    select_target -> analyze_attack_surface;
    analyze_attack_surface -> identify_entry_points;
    identify_entry_points -> map_data_flow;

    // Flow - Static Discovery
    map_data_flow -> static_vuln_phase;
    static_vuln_phase -> spawn_vulnerability_hunter;
    spawn_vulnerability_hunter -> detect_memory_bugs;
    spawn_vulnerability_hunter -> find_logic_flaws;
    spawn_vulnerability_hunter -> check_crypto_issues;
    spawn_vulnerability_hunter -> scan_injection_points;
    detect_memory_bugs -> connascence_scan;
    find_logic_flaws -> connascence_scan;
    check_crypto_issues -> connascence_scan;
    scan_injection_points -> connascence_scan;
    connascence_scan -> triage_static_findings;

    // Flow - Dynamic Testing
    triage_static_findings -> dynamic_vuln_phase;
    dynamic_vuln_phase -> setup_fuzzing;
    setup_fuzzing -> configure_fuzzer;
    configure_fuzzer -> generate_corpus;
    generate_corpus -> run_fuzzing_campaign;
    run_fuzzing_campaign -> monitor_coverage;
    monitor_coverage -> detect_crashes;

    // Flow - Crash Analysis
    detect_crashes -> crash_analysis_phase;
    crash_analysis_phase -> triage_crashes;
    triage_crashes -> minimize_testcase;
    minimize_testcase -> analyze_root_cause;
    analyze_root_cause -> classify_vulnerability;
    classify_vulnerability -> assess_severity;

    // Flow - Exploitability
    assess_severity -> exploit_phase;
    exploit_phase -> check_mitigations;
    check_mitigations -> analyze_constraints;
    analyze_constraints -> develop_exploit_strategy;
    develop_exploit_strategy -> build_poc;
    build_poc -> test_exploit;
    test_exploit -> refine_exploit;

    // Flow - Disclosure
    refine_exploit -> disclosure_phase;
    disclosure_phase -> prepare_advisory;
    prepare_advisory -> assign_cve;
    assign_cve -> coordinate_disclosure;
    coordinate_disclosure -> generate_report_cmd;
    generate_report_cmd -> document_impact;

    // Flow - Patch (Optional)
    document_impact -> patch_phase;
    patch_phase -> develop_patch;
    develop_patch -> test_patch;
    test_patch -> patch_binary_cmd;
    patch_binary_cmd -> verify_patch;

    // Flow - Integration & Output
    verify_patch -> memory_store;
    document_impact -> memory_store [label="Skip Patch"];
    memory_store -> share_findings;
    share_findings -> deliverables;
    deliverables -> end;

    // Metadata
    label="vulnerability-research Skill - Complete Workflow";
    fontsize=16;
    fontname="Arial Bold";
}
