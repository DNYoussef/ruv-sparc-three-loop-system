digraph REVulnerabilityHunterAgent {
    rankdir=TB;
    node [shape=box, style="rounded,filled", fillcolor=lightblue];
    edge [color=darkblue, penwidth=2];

    // Agent definition
    start [label="RE-vulnerability-hunter\nAgent Activated", fillcolor=lightgreen];

    // Static vulnerability analysis
    static_vuln_scan [label="Static Vulnerability\nScanning", fillcolor=lightyellow];
    detect_buffer_overflow [label="Detect Buffer\nOverflow Patterns"];
    find_format_strings [label="Find Format String\nVulnerabilities"];
    identify_use_after_free [label="Identify Use-After-Free\nPatterns"];
    detect_race_conditions [label="Detect Race\nConditions"];
    analyze_integer_overflow [label="Analyze Integer\nOverflow Risks"];
    check_injection_points [label="Check Injection\nPoints (SQL, Cmd)"];

    // Code quality checks
    code_quality [label="Code Quality\nAnalysis", fillcolor=lightyellow];
    detect_unsafe_functions [label="Detect Unsafe\nFunctions (strcpy, gets)"];
    analyze_memory_leaks [label="Analyze Memory\nLeak Patterns"];
    check_uninitialized [label="Check Uninitialized\nVariables"];

    // Dynamic vulnerability testing
    dynamic_vuln_test [label="Dynamic Vulnerability\nTesting", fillcolor=lightyellow];
    setup_fuzzer [label="Setup Fuzzer\n(AFL/libFuzzer)"];
    generate_test_cases [label="Generate Test\nCases"];
    monitor_crashes [label="Monitor Crashes\n& Exceptions"];
    analyze_crash_dumps [label="Analyze Crash\nDumps"];
    triage_findings [label="Triage Vulnerability\nFindings"];

    // Exploit development
    exploit_analysis [label="Exploit Analysis\nPhase", fillcolor=lightyellow];
    check_exploitability [label="Check Exploitability\n(DEP, ASLR, Stack Canaries)"];
    develop_poc [label="Develop Proof of\nConcept"];

    // Integration
    connascence_scan [label="Scan with Connascence\nAnalyzer MCP"];
    memory_coordination [label="Store Findings in\nMemory MCP"];
    generate_report [label="Generate Vulnerability\nReport"];
    export_cve_format [label="Export to CVE\nFormat"];

    end [label="Vulnerability Hunt\nComplete", fillcolor=lightcoral];

    // Flow
    start -> static_vuln_scan;
    static_vuln_scan -> detect_buffer_overflow;
    detect_buffer_overflow -> find_format_strings;
    find_format_strings -> identify_use_after_free;
    identify_use_after_free -> detect_race_conditions;
    detect_race_conditions -> analyze_integer_overflow;
    analyze_integer_overflow -> check_injection_points;

    check_injection_points -> code_quality;
    code_quality -> detect_unsafe_functions;
    detect_unsafe_functions -> analyze_memory_leaks;
    analyze_memory_leaks -> check_uninitialized;

    check_uninitialized -> dynamic_vuln_test;
    dynamic_vuln_test -> setup_fuzzer;
    setup_fuzzer -> generate_test_cases;
    generate_test_cases -> monitor_crashes;
    monitor_crashes -> analyze_crash_dumps;
    analyze_crash_dumps -> triage_findings;

    triage_findings -> exploit_analysis;
    exploit_analysis -> check_exploitability;
    check_exploitability -> develop_poc;

    develop_poc -> connascence_scan;
    connascence_scan -> memory_coordination;
    memory_coordination -> generate_report;
    generate_report -> export_cve_format;
    export_cve_format -> end;

    // Metadata
    label="RE-vulnerability-hunter Agent Process Flow";
    fontsize=16;
    fontname="Arial Bold";
}
