digraph performance_analyzer_template_workflow {
    // Graph properties
    rankdir=TB;
    bgcolor="#f8f9fa";
    fontname="Arial";
    fontsize=14;
    label="Performance Analyzer Template Agent Workflow\nAgent ID: agent-091 | Category: Templates\nPurpose: Template-based performance analysis";
    labelloc=t;

    // Node styling
    node [fontname="Arial", fontsize=11, style="filled"];

    // Start/End
    start [label="Analysis Request", shape=oval, fillcolor="#e8f5e9", color="#4caf50", penwidth=2];
    end [label="Analysis\nComplete", shape=oval, fillcolor="#e8f5e9", color="#4caf50", penwidth=2];

    // Phase 1: Template Selection
    subgraph cluster_template {
        label="Phase 1: Template Selection";
        style=filled;
        fillcolor="#fff3e0";
        color="#ff9800";
        penwidth=2;

        t1 [label="Select Analysis\nTemplate", shape=box, fillcolor="#ffecb3"];
        t2 [label="Load Template\nConfiguration", shape=box, fillcolor="#ffecb3"];
        t3 [label="Customize\nParameters", shape=box, fillcolor="#ffecb3"];
        t4 [label="Verify Template\nApplicability", shape=box, fillcolor="#ffecb3"];

        t1 -> t2 -> t3 -> t4;
    }

    // Phase 2: Data Collection
    subgraph cluster_collection {
        label="Phase 2: Data Collection";
        style=filled;
        fillcolor="#e3f2fd";
        color="#2196f3";
        penwidth=2;

        c1 [label="Instrument Code", shape=box, fillcolor="#bbdefb"];
        c2 [label="Collect Metrics", shape=box, fillcolor="#bbdefb"];
        c3 [label="Monitor Resource\nUsage", shape=box, fillcolor="#bbdefb"];
        c4 [label="Capture Timing\nData", shape=box, fillcolor="#bbdefb"];

        c1 -> c2 -> c3 -> c4;
    }

    // Phase 3: Analysis Execution
    subgraph cluster_analysis {
        label="Phase 3: Analysis Execution";
        style=filled;
        fillcolor="#f3e5f5";
        color="#9c27b0";
        penwidth=2;

        a1 [label="Run Profiling", shape=box, fillcolor="#e1bee7"];
        a2 [label="Identify\nBottlenecks", shape=box, fillcolor="#e1bee7"];
        a3 [label="Calculate\nMetrics", shape=box, fillcolor="#e1bee7"];
        a4 [label="Compare Against\nBaseline", shape=box, fillcolor="#e1bee7"];

        a1 -> a2 -> a3 -> a4;
    }

    // Phase 4: Pattern Recognition
    subgraph cluster_patterns {
        label="Phase 4: Pattern Recognition";
        style=filled;
        fillcolor="#fce4ec";
        color="#e91e63";
        penwidth=2;

        p1 [label="Detect Common\nAnti-patterns", shape=box, fillcolor="#f8bbd0"];
        p2 [label="Identify\nOptimization\nOpportunities", shape=box, fillcolor="#f8bbd0"];
        p3 [label="Suggest\nImprovements", shape=box, fillcolor="#f8bbd0"];

        p1 -> p2 -> p3;
    }

    // Phase 5: Reporting
    subgraph cluster_reporting {
        label="Phase 5: Reporting";
        style=filled;
        fillcolor="#e0f2f1";
        color="#009688";
        penwidth=2;

        r1 [label="Generate\nPerformance Report", shape=box, fillcolor="#b2dfdb"];
        r2 [label="Create\nVisualizations", shape=box, fillcolor="#b2dfdb"];
        r3 [label="Prioritize\nRecommendations", shape=box, fillcolor="#b2dfdb"];
        r4 [label="Export Results", shape=box, fillcolor="#b2dfdb"];

        r1 -> r2 -> r3 -> r4;
    }

    // Decision
    threshold [label="Performance\nAcceptable?", shape=diamond, fillcolor="#ffeb3b", color="#f57f17", penwidth=2];

    // Flow
    start -> t1;
    t4 -> c1;
    c4 -> a1;
    a4 -> p1;
    p3 -> threshold;

    threshold -> r1 [label="Yes"];
    threshold -> p2 [label="No - Optimize", style=dashed, color="#ff9800"];

    r4 -> end;

    // Capabilities
    capabilities [label="Key Capabilities:\n• Template-based Analysis\n• Reusable Patterns\n• Standardized Metrics\n• Bottleneck Detection\n• Optimization Suggestions\n• Automated Reporting", shape=note, fillcolor="#e8eaf6", color="#3f51b5", fontsize=10];

    // Template categories
    templates [label="Template Types:\n• CPU Profiling\n• Memory Analysis\n• I/O Performance\n• Database Queries\n• API Response Times", shape=note, fillcolor="#ede7f6", color="#673ab7", fontsize=10];

    // Metadata
    metadata [label="Agent: performance-analyzer-template\nPriority: Medium\nComplexity: Medium\nGraphviz Priority: 91", shape=note, fillcolor="#f5f5f5", color="#9e9e9e", fontsize=9];
}
