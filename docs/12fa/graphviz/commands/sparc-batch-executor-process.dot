// SPARC Batch Executor Command Workflow
// Parallel batch processing
digraph sparc_batch_executor_command {
    graph [rankdir=TB, bgcolor="#0a0e1a", fontname="Arial", fontsize=12, splines=ortho, nodesep=0.6, ranksep=1.0];
    node [shape=box, style="rounded,filled", fontname="Arial", fontsize=10, margin=0.2];
    edge [fontname="Arial", fontsize=9, color="#4a90e2"];

    subgraph cluster_trigger {
        label="Command Trigger";
        style=filled;
        color="#1a1f35";
        fontcolor="#ffffff";

        cmd_trigger [label="/sparc:batch-executor\nCommand", fillcolor="#d97706", fontcolor="#ffffff"];
        task_loader [label="Task\nLoader", fillcolor="#2d3748", fontcolor="#ffffff"];
    }

    subgraph cluster_preparation {
        label="Batch Preparation";
        style=filled;
        color="#1a1f35";
        fontcolor="#ffffff";

        task_validator [label="Task\nValidator", fillcolor="#2563eb", fontcolor="#ffffff"];
        dependency_resolver [label="Dependency\nResolver", fillcolor="#2563eb", fontcolor="#ffffff"];
        batch_organizer [label="Batch\nOrganizer", fillcolor="#2563eb", fontcolor="#ffffff"];
        priority_sorter [label="Priority\nSorter", fillcolor="#2563eb", fontcolor="#ffffff"];
    }

    subgraph cluster_execution {
        label="Parallel Execution";
        style=filled;
        color="#1a1f35";
        fontcolor="#ffffff";

        worker_pool [label="Worker\nPool", fillcolor="#10b981", fontcolor="#ffffff"];
        task_dispatcher [label="Task\nDispatcher", fillcolor="#10b981", fontcolor="#ffffff"];
        progress_tracker [label="Progress\nTracker", fillcolor="#10b981", fontcolor="#ffffff"];
        error_handler [label="Error\nHandler", fillcolor="#10b981", fontcolor="#ffffff"];
    }

    subgraph cluster_aggregation {
        label="Result Aggregation";
        style=filled;
        color="#1a1f35";
        fontcolor="#ffffff";

        result_collector [label="Result\nCollector", fillcolor="#7c3aed", fontcolor="#ffffff"];
        success_validator [label="Success\nValidator", fillcolor="#7c3aed", fontcolor="#ffffff"];
        failure_analyzer [label="Failure\nAnalyzer", fillcolor="#7c3aed", fontcolor="#ffffff"];
    }

    subgraph cluster_output {
        label="Output";
        style=filled;
        color="#1a1f35";
        fontcolor="#ffffff";

        batch_report [label="Batch\nReport", fillcolor="#059669", fontcolor="#ffffff"];
        execution_log [label="Execution\nLog", fillcolor="#059669", fontcolor="#ffffff"];
    }

    cmd_trigger -> task_loader;
    task_loader -> task_validator -> dependency_resolver -> batch_organizer -> priority_sorter;
    priority_sorter -> worker_pool -> task_dispatcher -> progress_tracker -> error_handler;
    error_handler -> result_collector -> success_validator -> failure_analyzer;
    failure_analyzer -> batch_report -> execution_log;
    execution_log -> cmd_trigger [label="Complete", style=bold, color="#10b981"];

    error_handler -> task_dispatcher [label="Retry", style=dashed, color="#ef4444"];

    subgraph cluster_legend {
        label="Legend";
        style=filled;
        color="#1a1f35";
        fontcolor="#ffffff";

        legend1 [label="SPARC", fillcolor="#d97706", fontcolor="#ffffff"];
        legend2 [label="Preparation", fillcolor="#2563eb", fontcolor="#ffffff"];
        legend3 [label="Parallel Exec", fillcolor="#10b981", fontcolor="#ffffff"];
    }
}
